var tent=tent||{};tent.global=typeof window=="undefined"?this:window;
tent.Namespace=function(e,c){if(!c)if(e){c=e;e=tent.global}else throw"must specify namespace path";if(c===".."){if(e===tent.global)throw"cannot use '..' at top level";return e.parent}var d=c.indexOf(".");d<0||c.indexOf(".",d+1);var f=e===tent.global?"":e.fullname+"";if(f)f+=".";f+=c;if(d<0)if(typeof e[c]=="undefined"){this.fullname=f;this.name=c;this.parent=e;e[c]=this}else if(!e[c]instanceof tent.Namespace)throw'error creating namespace: "'+f+'" is not a Namespace object';else return e[c];else return new tent.Namespace(new tent.Namespace(e,
c.slice(0,d)),c.slice(d+1));return this};tent.__tentTmp=new tent.Namespace("__tentTmp");tent.__tentTmp.Namespace=tent.Namespace;tent.__tentTmp.fullname="tent";tent.__tentTmp.name="tent";tent.__tentTmp.parent=tent.global;tent.__tentTmp.global=tent.global;tent.global.tent=tent.__tentTmp;delete tent.__tentTmp;try{delete tent.global.__tentTmp}catch(ex){}
tent.Namespace.prototype.expand=function(e){if(e instanceof Function)e(this);else if(typeof e=="object")for(var c in e)if(e.hasOwnProperty(c)){if(typeof this[c]!="undefined")throw this.fullname+"."+c+" already exists";this[c]=e[c]}return this};
tent.declare=function(){for(var e,c=0;c<arguments.length;c++){var d=arguments[c];if(d instanceof tent.Namespace)e=d;else if(typeof d=="string")e=e?new tent.Namespace(e,d):new tent.Namespace(d);else if(d instanceof Function||typeof d=="object"){if(!e)throw"no namespace provided";e.expand(d)}else throw"invalid argument type at index "+c+", expected Namespace, string, Function";}return e};
tent.mixin=function(e,c){for(var d in c.prototype)if(c.prototype.hasOwnProperty(d))e.prototype[d]=c.prototype[d];return e};tent.combineOptions=function(){for(var e={},c=0,d=arguments.length;c<d;c++){var f=arguments[c],h;for(h in f)if(f.hasOwnProperty(h))e[h]=tent.clone(f[h],{deep:true,ignoreCircularReferences:true})}return e};
tent.isDOMObject=function(e){if(typeof Node!="undefined"&&e instanceof Node||typeof Element!="undefined"&&e instanceof Element||typeof NodeList!="undefined"&&e instanceof NodeList||e===window||e===document)return true;if(typeof o==="object"&&typeof o.nodeType==="number"&&typeof o.nodeName==="string")return true;return false};
tent.DOMPropertyNames=["nextSibling","onresizeend","onrowenter","aria-haspopup","childNodes","ondragleave","canHaveHTML","onbeforepaste","ondragover","onbeforecopy","aria-disabled","onpage","recordNumber","previousSibling","nodeName","onbeforeactivate","accessKey","currentStyle","scrollLeft","onbeforeeditfocus","oncontrolselect","aria-hidden","onblur","hideFocus","clientHeight","style","onbeforedeactivate","dir","aria-expanded","onkeydown","nodeType","ondragstart","onscroll","onpropertychange","ondragenter",
"id","aria-level","onrowsinserted","scopeName","lang","onmouseup","aria-busy","oncontextmenu","language","scrollTop","offsetWidth","onbeforeupdate","onreadystatechange","onmouseenter","filters","onresize","isContentEditable","aria-checked","aria-readonly","oncopy","onselectstart","scrollHeight","onmove","ondragend","onrowexit","lastChild","aria-secret","onactivate","canHaveChildren","onfocus","onfocusin","isMultiLine","onmouseover","offsetTop","oncut","parentNode","tagName","className","onmousemove",
"title","role","behaviorUrns","onfocusout","onfilterchange","disabled","parentTextEdit","ownerDocument","offsetParent","aria-posinset","ondrop","ondblclick","onrowsdelete","tabIndex","onkeypress","aria-relevant","onlosecapture","innerText","aria-live","parentElement","ondeactivate","aria-labelledby","aria-pressed","children","ondatasetchanged","ondataavailable","aria-invalid","onafterupdate","nodeValue","onmousewheel","onkeyup","readyState","onmovestart","aria-valuenow","aria-selected","onmouseout",
"aria-owns","aria-valuemax","onmoveend","contentEditable","document","firstChild","sourceIndex","outerText","isTextEdit","isDisabled","oncellchange","runtimeStyle","scrollWidth","aria-valuemin","onlayoutcomplete","onhelp","attributes","offsetHeight","onerrorupdate","onmousedown","clientTop","aria-setsize","clientWidth","onpaste","tagUrn","onmouseleave","onclick","outerHTML","ondrag","aria-controls","onresizestart","aria-flowto","ondatasetcomplete","aria-required","clientLeft","aria-describedby","all",
"onbeforecut","innerHTML","aria-activedescendant","aria-multiselectable","offsetLeft","dataSrc","dataFld","dataFormatAs","name","nextSibling","onresizeend","onrowenter","aria-haspopup","childNodes","ondragleave","canHaveHTML","onbeforepaste","ondragover","onbeforecopy","aria-disabled","onpage","recordNumber","previousSibling","nodeName","onbeforeactivate","accessKey","currentStyle","scrollLeft","onbeforeeditfocus","oncontrolselect","aria-hidden","onblur","hideFocus","clientHeight","style","onbeforedeactivate",
"dir","aria-expanded","onkeydown","nodeType","ondragstart","onscroll","onpropertychange","ondragenter","id","aria-level","onrowsinserted","scopeName","lang","onmouseup","aria-busy","oncontextmenu","language","scrollTop","offsetWidth","onbeforeupdate","onreadystatechange","onmouseenter","filters","onresize","isContentEditable","aria-checked","aria-readonly","oncopy","onselectstart","scrollHeight","onmove","ondragend","onrowexit","lastChild","aria-secret","onactivate","canHaveChildren","onfocus","onfocusin",
"isMultiLine","onmouseover","offsetTop","oncut","parentNode","tagName","className","onmousemove","title","role","behaviorUrns","onfocusout","onfilterchange","disabled","parentTextEdit","ownerDocument","offsetParent","aria-posinset","ondrop","ondblclick","onrowsdelete","tabIndex","onkeypress","aria-relevant","onlosecapture","innerText","aria-live","parentElement","ondeactivate","aria-labelledby","aria-pressed","children","ondatasetchanged","ondataavailable","aria-invalid","onafterupdate","nodeValue",
"onmousewheel","onkeyup","readyState","onmovestart","aria-valuenow","aria-selected","onmouseout","aria-owns","aria-valuemax","onmoveend","contentEditable","document","firstChild","sourceIndex","outerText","isTextEdit","isDisabled","oncellchange","runtimeStyle","scrollWidth","aria-valuemin","onlayoutcomplete","onhelp","attributes","offsetHeight","onerrorupdate","onmousedown","clientTop","aria-setsize","clientWidth","onpaste","tagUrn","onmouseleave","onclick","outerHTML","ondrag","aria-controls","onresizestart",
"aria-flowto","ondatasetcomplete","aria-required","clientLeft","aria-describedby","all","onbeforecut","innerHTML","aria-activedescendant","aria-multiselectable","offsetLeft","dataSrc","dataFld","dataFormatAs","name"];tent.isDOMProperty=function(e){if(!tent.DOMPropertyNames.indexOf)tent.DOMPropertyNames.indexOf=tent.arrays.functions.indexOf;return tent.DOMPropertyNames.indexOf(e)>=0};
tent.clone=function(e,c){if(e===null)return null;else if(typeof e=="undefined")return;else if(typeof e=="object"){if(c&&c.onlyForTracking&&tent.changes.getPropertyInterceptMode()!=tent.changes.PropertyInterceptModes.DEFINEPROPERTYONLYDOM)return e;if(c){if(c.deep&&!c.deepStack)c.deepStack=tent.arrays.extend([])}else c={};if(e instanceof Array)for(var d=[],f=0;f<e.length;f++)if(typeof e[f]=="object"&&c.deep){c.deepStack.push(e);if(c.deepStack.lastIndexOf(e[f])<0)if(c.attachedObjectsIds&&e[f].__collection__)d.push(tent.entities.getId(e[f]));
else{if(c.attachedObjects!==false||!e[f].__collection__)d.push(tent.clone(e[f],c))}else if(!c.ignoreCircularReferences)throw"Circular reference when cloning array";c.deepStack.pop()}else d.push(e[f]);else{d=c.dom?document.createElement("span"):{};for(f in e)if(!(c.onlyOwnProperties&&!e.hasOwnProperty(f))){var h=f.substr(0,1)=="_";if(!(c.skipPrivates&&h))if(!c.clonePrivates&&h){h=e.__observable__?tent.pget(e,f):e[f];if(typeof h=="object"&&c.attachedObjectsIds&&h.__collection__)d[f]=tent.entities.getId(h);
else typeof h=="object"&&c.attachedObjects===false&&h.__collection__||(d[f]=h)}else{h=e.__observable__?tent.pget(e,f):e[f];if(c.deep&&typeof h=="object")if(c.attachedObjectsIds&&h.__collection__)d[f]=tent.entities.getId(h);else{if(!(c.attachedObjects===false&&h.__collection__)){c.deepStack.push(e);if(c.deepStack.indexOf(h)<0)d[f]=tent.clone(h,c);else if(!c.ignoreCircularReferences)throw"Circular reference when cloning object";c.deepStack.pop()}}else d[f]=h}}}return d}return e};tent.declare("tent.arrays",function(){tent.arrays.extend=function(e,c){for(var d in tent.arrays.functions)if(c||!(e[d]instanceof Function))e[d]=tent.arrays.functions[d];return e};tent.arrays.functions={findByProperty:function(e,c){for(var d=0,f=this.length;d<f;d++)if(this[d][e]===c)return this[d];return null},first:function(e){for(var c=0,d=this.length;c<d;c++)if(e(this[c]))return this[c];return null},indexByProperty:function(e,c){for(var d=0,f=this.length;d<f;d++)if(this[d][e]===c)return d;return-1},
indexOf:function(e){for(var c=0,d=this.length;c<d;c++)if(this[c]===e)return c;return-1},lastIndexOf:function(e){for(var c=this.length-1;c>0;c--)if(this[c]===e)return c;return-1},filter:function(e){for(var c=[],d=0,f=this.length;d<f;d++)e(this[d])&&c.push(this[d]);return c},remove:function(){for(var e,c=0,d=this.length;c<d;c++)for(var f=0,h=arguments.length;f<h;f++)if(this[c]==arguments[f]){this.splice(c,1);e=true;c--;d--;break}if(e)return true;return false},set:function(e,c){this.splice(e,1,c)},pushUnique:function(){if(arguments.length==
1){for(var e=false,c=0,d=this.length;c<d;c++)if(this[c]==arguments[0]){e=true;break}e||this.push(arguments[0])}else{e=[];c=0;for(d=this.length;c<d;c++)for(var f=0,h=arguments.length;f<h;f++)if(this[c]==arguments[f])e[f]=true;f=0;for(h=arguments.length;f<h;f++)e[f]||this.push(arguments[f])}return this.length},clone:function(){var e=[];Array.prototype.push.apply(e,this);return e},isCloneOf:function(e){if(!e)return false;if(this.length!=e.length)return false;if(this===e)return false;for(var c=this.length;c>=
0;c--)if(this[c]!==e[c])return false;return true}}});tent.declare("tent.coreTypes",function(){tent.coreTypes.Enum=function(){this.__names__=[];this.__values__={};this.__flags__=false;this.__enum=true;arguments.length>0&&this.add.apply(this,arguments)};tent.coreTypes.Enum.prototype.getName=function(d){if(this.__names__)if(this.__names__[d])return this.__names__[d];else if(this.__flags__){d=d;var f="",h;for(h in this.__values__)if(this.__values__[h]&&(this.__values__[h]&d)===this.__values__[h]){d-=this.__values__[h];if(f)f+="|";f+=h}if(f&&d===0)return f;
else if(f)return f+"|"+d}};tent.coreTypes.Enum.prototype.__freeValue__=function(){var d=typeof this.__maxValue__=="undefined"?1:this.__maxValue__+1;if(this.__values__&&typeof this.__values__[d]!="undefined")for(var f in this.__values__)if(this.__values__[f]>=d){this.__maxValue__=this.__values__[f];d=this.__values__[f]+1}if(this.__flags__)d=d<1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.log(2)));return d};tent.coreTypes.Enum.prototype.useFlags=function(d){this.__flags__=d;return this};var e=function(d,
f,h){d[f]=h;d.__values__[f]=h;if(typeof d.__names__[h]=="undefined")d.__names__[h]=f;if(typeof d.__maxValue__=="undefined"||d.__maxValue__<h)d.__maxValue__=h};tent.coreTypes.Enum.prototype.add=function(){if(arguments.length<1)return this;for(var d,f,h=0,k=arguments.length;h<k;h++){d=arguments[h];if(d instanceof Array)this.add.apply(this,d);else if(typeof d=="object")for(f in d)if(d.hasOwnProperty(f)){var a=this.__values__[f];if(!a instanceof Number||typeof this.__names__[a]!="undefined")a=this.__freeValue__();
e(this,f,a)}if(typeof d=="string")if(d){d=d.split(",");a=0;for(var b=d.length;a<b;a++){f=d[a].replace(/^\s+/g,"").replace(/\s+$/g,"");if(f=="_FLAGS")this.useFlags(true);else{if(typeof this.__values__[f]!="undefined")if(this.__values__[f]instanceof Number)throw"Enum duplicate name found: "+f;else throw"Enum invalid name (reserved): "+f;if(a==b-1&&h<k-1&&typeof arguments[h+1]=="number"){e(this,f,arguments[h+1]);h++}else e(this,f,this.__freeValue__())}}}}return this};var c=function(){var d=this._name+
(this._count>1?"("+this._count+")":"");if(this._childrenCount){d+="{";var f=0,h;for(h in this)if(h.substr(0,1)!="_"&&typeof this[h]=="object"){if(f>0)d+=", ";d+=this[h];f++}d+="}"}return d};tent.coreTypes.NameCounter=function(d){this.root={_name:d||"",_count:0,toString:c}};tent.coreTypes.NameCounter.prototype.__nodeAdd__=function(d,f){d._count=(d._count||0)+f;if(d._parent){if(d._count==0&&!d._childrenCount){d._parent._childrenCount&&d._parent._childrenCount--;delete d._parent[d._name]}this.__nodeAdd__(d._parent,
f)}};tent.coreTypes.NameCounter.prototype.add=function(d,f){if(typeof f!="number")f=1;for(var h=d.split("."),k=this.root,a=0;a<h.length;a++){if(typeof k[h[a]]=="undefined"){k._childrenCount=(k._childrenCount||0)+1;k[h[a]]={_parent:k,_name:h[a],_count:0,toString:c}}k=k[h[a]]}this.__nodeAdd__(k,f)};tent.coreTypes.NameCounter.prototype.reset=function(){this.root={_name:this.root._name,_count:0,toString:c}};tent.coreTypes.NameCounter.prototype.toString=function(){return c.apply(this.root)}});tent.declare("tent.logging",function(){tent.logging.Levels=new tent.coreTypes.Enum("TRACE,DEBUG,INFO,WARN,ERROR,FATAL");tent.logging.Log=function(){this.listeners=[]};tent.logging.Log.prototype.bindToConsole=function(e){typeof console!="undefined"&&this.bind(tent.logging.consoleLogger,e);return this};tent.logging.Log.prototype.bindToAlert=function(e){this.bind(tent.logging.alertLogger,e);return this};tent.logging.Log.prototype.bindToHtml=function(e,c){this.bind(tent.logging.createHtmlAppendLogger(e),
c);return this};tent.logging.Log.prototype.unbindConsole=function(){typeof console!="undefined"&&this.unbind(tent.logging.consoleLogger);return this};tent.logging.Log.prototype.unbindAlert=function(){this.unbind(tent.logging.alertLogger,level);return this};tent.logging.Log.prototype.unbindHtml=function(e){for(var c=this.listeners.length;c>=0;c--)this.listeners[c].callback.outputElement===e&&this.listeners.splice(c,1);return this};tent.logging.Log.prototype.bind=function(e,c){if(!e instanceof Function)throw"a callback Function must be provided";
var d=c;if(typeof d!="number")d=typeof d=="undefined"?tent.logging.Levels.TRACE:tent.logging.Levels[d]||tent.logging.Levels.TRACE;for(var f=false,h=this.listeners.length-1;h>=0;h--){var k=this.listeners[h];if(k.callback===e){k.level=d;f=true}}f||this.listeners.push({callback:e,level:d});return this};tent.logging.Log.prototype.unbind=function(e){if(!e instanceof Function)throw"a callback Function must be provided";for(var c=this.listeners.length;c>=0;c--)this.listeners[c].callback===e&&this.listeners.splice(c,
1);return this};tent.logging.Log.prototype.notify=function(e,c){var d=c;if(typeof d!="number")d=d?tent.logging.Levels[d]||tent.logging.Levels.INFO:tent.logging.Levels.INFO;for(var f=0,h=this.listeners.length;f<h;f++){var k=this.listeners[f];if(k.callback)if(typeof k.level=="undefined"||k.level<=d)k.callback(e,c)}};tent.logging.Log.prototype.trace=function(){this.notify(this.stringOrStringify.apply(this,arguments),tent.logging.Levels.TRACE)};tent.logging.Log.prototype.debug=function(){this.notify(this.stringOrStringify.apply(this,
arguments),tent.logging.Levels.DEBUG)};tent.logging.Log.prototype.info=function(){this.notify(this.stringOrStringify.apply(this,arguments),tent.logging.Levels.INFO)};tent.logging.Log.prototype.warn=function(){this.notify(this.stringOrStringify.apply(this,arguments),tent.logging.Levels.WARN)};tent.logging.Log.prototype.error=function(){this.notify(this.stringOrStringify.apply(this,arguments),tent.logging.Levels.ERROR)};tent.logging.Log.prototype.fatal=function(){this.notify(this.stringOrStringify.apply(this,
arguments),tent.logging.Levels.FATAL)};tent.logging.Log.prototype.stringify=function(){var e="";try{var c=arguments.length>0&&arguments[arguments.length-1]&&arguments[arguments.length-1]._options?arguments[arguments.length-1]:{_options:true};if(!c.deepStack){c.deepStack=[];tent.arrays.extend(c.deepStack)}for(var d=0,f=arguments.length;d<f;d++)if(!(arguments[d]&&typeof arguments[d]=="object"&&arguments[d]._options))if(!(arguments[d]instanceof Function)){if(e)e+=", ";if(c.deepStack.length>3||c.deepStack.lastIndexOf(arguments[d])>=
0)e+="#";else if(typeof arguments[d]=="undefined")e+="undefined";else if(arguments[d]==null)e+="null";else if(arguments[d]instanceof Array){var h=tent.arrays.functions.clone.apply(arguments[d]).filter(function(g){if(g instanceof Function)return false;if(c.deepStack.lastIndexOf(g>=0))return false;return true});h.push(c);c.deepStack.push(arguments[d]);e+="[";if(c.deepStack.length<4)e+=this.stringify.apply(this,h);c.deepStack.pop();e+="]"}else if(typeof arguments[d]=="string")e+='"'+arguments[d]+'"';
else if(arguments[d]instanceof Date)e+='"'+arguments[d]+'"';else if(typeof arguments[d]=="object"){var k="";c.deepStack.push(arguments[d]);if(c.deepStack.length<4)for(var a in arguments[d])if(!(arguments[d][a]instanceof Function))if(!(c.deepStack.lastIndexOf(arguments[d][a])>=0)){if(k)k+=", ";k+='"'+a+'": '+this.stringify.apply(this,[arguments[d][a],c])}c.deepStack.pop();e+="{"+k+"}"}else e+=arguments[d]}}catch(b){return"#err#"}return e};tent.logging.Log.prototype.stringOrStringify=function(){return arguments.length==
1&&typeof arguments[0]=="string"?arguments[0]:this.stringify.apply(this,arguments)};tent.logging.consoleLogger=function(e,c){if(c==tent.logging.Levels.TRACE)console.trace?console.trace(e):console.info(e);if(c==tent.logging.Levels.DEBUG)console.debug?console.debug(e):console.info(e);c==tent.logging.Levels.INFO&&console.info(e);if(c==tent.logging.Levels.WARN)console.warn?console.warn(e):console.info(e);c==tent.logging.Levels.ERROR&&console.error(e);c==tent.logging.Levels.FATAL&&console.error(e)};tent.logging.alertLogger=
function(e){alert(e)};tent.logging.createHtmlAppendLogger=function(e){var c=null;c=e.tagName=="INPUT"?function(d,f){e.value+="\n["+tent.logging.Levels.getName(f)+"] "+d}:e.tagName=="UL"?function(d,f){var h=document.createElement("li");h.innerHTML="["+tent.logging.Levels.getName(f)+"] "+d;e.appendChild(h)}:e.tagName=="TABLE"?function(d,f){var h=document.createElement("tr"),k=document.createElement("td");k.setAttribute("class","eventType");k.innerHTML=tent.logging.Levels.getName(f);h.appendChild(k);
k=document.createElement("td");k.setAttribute("class","eventMessage");k.innerHTML=d.replace(/(\<)/g,"&lt;").replace(/(\>)/g,"&gt;").replace(/(\&)/g,"&amp;").replace(/(\s)/g,"&nbsp;");h.appendChild(k);e.tBodies[0].appendChild(h)}:function(d,f){e.innerHTML+="<br/>["+tent.logging.Levels.getName(f)+"] "+d};c.outputElement=e;return c};tent.log=(new tent.logging.Log).bindToConsole()});tent.declare("tent.changes",function(){tent.changes.EventTypes=new tent.coreTypes.Enum("ANY,MANYCHANGES,CHANGING,CHANGED,ADDING,ADDED,REMOVING,REMOVED");tent.changes.InterceptorTypes=new tent.coreTypes.Enum("PROPERTY,FUNCTION");tent.changes.PropertyInterceptModes=new tent.coreTypes.Enum("NONE,DEFINESETTER,DEFINEPROPERTY,DEFINEPROPERTYONLYDOM");var e;tent.changes.getPropertyInterceptMode=function(){if(typeof e=="undefined"){var a={};if(Object.defineProperty)try{Object.defineProperty(a,"myproperty",
{get:function(){return this._myproperty},set:function(j){this._myproperty=j}});a.myproperty="my value";if(a.myproperty==="my value"&&a._myproperty==="my value")e=tent.changes.PropertyInterceptModes.DEFINEPROPERTY}catch(b){if(document&&document.createElement){a=document.createElement("span");try{Object.defineProperty(a,"myproperty",{get:function(){return this._myproperty},set:function(j){this._myproperty=j}});a.myproperty="my value";if(a.myproperty==="my value"&&a._myproperty==="my value")e=tent.changes.PropertyInterceptModes.DEFINEPROPERTYONLYDOM}catch(g){}}}if(typeof e==
"undefined"){a={};if(a.__defineSetter__)try{a.__defineGetter__("myproperty",function(){return this._myproperty});a.__defineSetter__("myproperty",function(j){this._myproperty=j});a.myproperty="my value";if(a.myproperty==="my value"&&a._myproperty==="my value")e=tent.changes.PropertyInterceptModes.DEFINESETTER}catch(i){}}if(typeof e=="undefined")e=tent.changes.PropertyInterceptModes.NONE}return e};tent.changes.getPropertyInterceptModeName=function(){return tent.changes.PropertyInterceptModes.getName(tent.changes.getPropertyInterceptMode())};
tent.changes.Change=function(a,b,g){this.subject=a;this.eventType=b;this.data=g};tent.changes.ChangeStringifiers=[];tent.changes.Change.prototype.toString=function(){if(typeof tent.changes.ChangeStringifiers[this.eventType]!="undefined")tent.changes.ChangeStringifiers[this.eventType](this);else{var a=tent.changes.EventTypes.getName(this.eventType);if(this.eventType==tent.changes.EventTypes.MANYCHANGES){a+=": ";if(this.data.length<=3)for(var b=0,g=this.data.length;b<g;b++)a+=this.data[b].toString()+
",";else{var i={};b=0;for(g=this.data.length;b<g;b++)i[this.data[b].eventType]=(i[this.data[b].eventType]||0)+1;for(var j in i)a+=tent.changes.EventTypes.getName(j)+"("+i[j]+"),"}}else{if(this.data.propertyName){a+=" "+this.data.propertyName;if(this.eventType==tent.changes.EventTypes.CHANGING)a+=" from "+this.data.current+" to "+this.data.newValue;else if(this.eventType==tent.changes.EventTypes.CHANGED)a+=" from "+this.data.oldValue+" to "+this.data.current;a+=" (on "+this.subject+")"}if(this.data.items){b=
this.data.items;a+=" "+b.length+(b.length>1?" items":" item");if(typeof this.data.index!="undefined")a+=" at index "+this.data.index;a+=this.data.propertyName?" ("+this.subject.__parent__+"."+this.data.propertyName+")":" (["+b+"])"}}return"[Change: "+a+"]"}};tent.changes.Observable=function(a){this.subject=a;this.handlers={};this.interceptors={};this.suspended=false;this.changesWhileSuspended=null};tent.changes.Observable.prototype.interceptFunction=function(a,b){if(!this.interceptors[a]){var g="_"+
a,i={name:a,_name:g,type:tent.changes.InterceptorTypes.FUNCTION};this.subject[g]=this.subject[a];this.subject[a]=b;this.interceptors[a]=i}};tent.pset=function(a,b,g,i){if(typeof b=="object"){for(var j in b)b.hasOwnProperty(j)&&tent.pset(a,j,b[j],g);return a}else{if(a.__observable__&&a.__observable__.interceptors&&a.__observable__.interceptors[b])if(i)a[a.__observable__.interceptors[b]._name||b]=g;else a.__observable__.interceptors[b].newsetter.call(a,g);else a[b]=g;return g}};tent.pget=function(a,
b){return a.__observable__&&a.__observable__.interceptors&&a.__observable__.interceptors[b]?a.__observable__.interceptors[b].newgetter.call(a):a[b]};tent.changes.Observable.prototype.interceptProperty=function(a,b,g,i){if(this.interceptors[a])return this.interceptors[a];var j={name:a,type:tent.changes.InterceptorTypes.PROPERTY,newsetter:i,newgetter:g};if(b){b="_"+a;try{this.subject[b]=this.subject[a]}catch(l){this.subject[b]=null}j._name=b}b=tent.changes.getPropertyInterceptMode();if(b==tent.changes.PropertyInterceptModes.DEFINEPROPERTY||
b==tent.changes.PropertyInterceptModes.DEFINEPROPERTYONLYDOM&&tent.isDOMObject(this.subject)){try{j.descriptor=Object.getOwnPropertyDescriptor(this.subject,a)}catch(m){}b={};if(g)b.get=g;if(i)b.set=i;try{Object.defineProperty(this.subject,a,b)}catch(p){tent.log.warn("Object.defineProperty for property '"+a+"' failed: "+p)}}else if(b==tent.changes.PropertyInterceptModes.DEFINESETTER){try{j.getter=this.subject.__lookupGetter__(a);j.setter=this.subject.__lookupSetter__(a)}catch(n){}if(g)try{this.subject.__defineGetter__(a,
g)}catch(q){tent.log.warn("Object.__defineGetter__ for property '"+a+"' failed: "+q)}if(i)try{this.subject.__defineSetter__(a,i)}catch(r){tent.log.warn("Object.__defineSetter__ for property '"+a+"' failed: "+r)}}if(j)this.interceptors[a]=j;return j};tent.changes.Observable.prototype.shouldNotifyParent=function(){return!!(this.parentObject&&this.parentObject!==this&&this.parentObjectPropertyName&&this.parentObject.__observable__&&this.parentObject.__observable__.interceptors&&this.parentObject.__observable__.interceptors[this.parentObjectPropertyName])};
tent.changes.Observable.prototype.notifyParentChanging=function(a){a.subject=this.subject;this.parentObject.__observable__.notifyChange(tent.changes.EventTypes.CHANGING,{propertyName:this.parentObjectPropertyName,innerChange:a})};tent.changes.Observable.prototype.notifyParentChanged=function(a){a.subject=this.subject;this.parentObject.__observable__.notifyChange(tent.changes.EventTypes.CHANGED,{propertyName:this.parentObjectPropertyName,innerChange:a})};var c=function(a,b){return function(g){var i=
this[b];if(i!=g){this.__observable__.notifyChange(tent.changes.EventTypes.CHANGING,{propertyName:a,current:i,newValue:g});var j=this.__observable__.shouldNotifyParent();j&&this.__observable__.notifyParentChanging({propertyName:a,current:i,newValue:g});this[b]=g;this.__observable__.notifyChange(tent.changes.EventTypes.CHANGED,{propertyName:a,current:g,oldValue:i});j&&this.__observable__.notifyParentChanged({propertyName:a,current:g,oldValue:i})}}},d=function(a,b){return function(){return this[b]}},
f=function(a,b){return b.substr(0,1)!="_"};tent.changes.Observable.prototype.interceptProperties=function(a){a||(a={});var b=a.propertyFilter||f,g=a.backPropertyPrefix||"_";a=!a.trackDomProperties&&this.isDOMObject();for(var i in this.subject)if(!(a&&tent.isDOMProperty(i)))try{if(typeof this.subject[i]!="function"&&b(this.subject,i)){var j=g+i;this.interceptProperty(i,j,d(i,j),c(i,j))}}catch(l){tent.log.warn("Error intercepting property '"+i+"': "+l)}return this};tent.changes.Observable.prototype.isDOMObject=
function(){if(typeof this._isDomObject=="undefined")this._isDOMObject=tent.isDOMObject(this.subject);return this._isDOMObject};tent.changes.Observable.prototype.interceptArrayModifiers=function(){if(!this.subject instanceof Array)return this;var a=this.subject;this.subject.setLength=function(b){if(this.length>b)this.splice(b,this.length-b);else this.lengh=b};this.interceptFunction("push",function(){var b=this.length,g=Array.prototype.slice.call(arguments);this.__observable__.notifyChange(tent.changes.EventTypes.ADDING,
{items:g,index:b,propertyName:this.__propertyName__});var i=this.__observable__.shouldNotifyParent();i&&this.__observable__.notifyParentChanging({type:tent.changes.EventTypes.ADDING,data:{items:g,index:b,propertyName:this.__propertyName__}});this._push.apply(this,arguments);this.__observable__.notifyChange(tent.changes.EventTypes.ADDED,{items:g,index:b,propertyName:this.__propertyName__});i&&this.__observable__.notifyParentChanged({type:tent.changes.EventTypes.ADDED,data:{items:g,index:b,propertyName:this.__propertyName__}})});
this.interceptFunction("unshift",function(){var b=Array.prototype.slice.call(arguments);this.__observable__.notifyChange(tent.changes.EventTypes.ADDING,{items:b,index:0,propertyName:this.__propertyName__});var g=this.__observable__.shouldNotifyParent();g&&this.__observable__.notifyParentChanging({type:tent.changes.EventTypes.ADDING,data:{items:b,index:0,propertyName:this.__propertyName__}});this._unshift.apply(this,arguments);this.__observable__.notifyChange(tent.changes.EventTypes.ADDED,{items:b,
index:0,propertyName:this.__propertyName__});g&&this.__observable__.notifyParentChanged({type:tent.changes.EventTypes.ADDED,data:{items:b,index:0,propertyName:this.__propertyName__}})});this.interceptFunction("pop",function(){var b=this.length-1;this.__observable__.notifyChange(tent.changes.EventTypes.REMOVING,{items:[this[b]],index:b,propertyName:this.__propertyName__});var g=this.__observable__.shouldNotifyParent();g&&this.__observable__.notifyParentChanging({type:tent.changes.EventTypes.REMOVING,
data:{items:[this[b]],index:b,propertyName:this.__propertyName__}});var i=this._pop();this.__observable__.notifyChange(tent.changes.EventTypes.REMOVED,{items:[i],index:b,propertyName:this.__propertyName__});g&&this.__observable__.notifyParentChanged({type:tent.changes.EventTypes.REMOVED,data:{items:[i],index:b,propertyName:this.__propertyName__}});return i});this.interceptFunction("shift",function(){this.__observable__.notifyChange(tent.changes.EventTypes.REMOVING,{items:[this[0]],index:0,propertyName:this.__propertyName__});
var b=this.__observable__.shouldNotifyParent();b&&this.__observable__.notifyParentChanging({type:tent.changes.EventTypes.REMOVING,data:{items:[this[0]],index:0,propertyName:this.__propertyName__}});var g=this._shift();this.__observable__.notifyChange(tent.changes.EventTypes.REMOVED,{items:[g],index:0,propertyName:this.__propertyName__});b&&this.__observable__.notifyParentChanged({type:tent.changes.EventTypes.REMOVED,data:{items:[g],index:0,propertyName:this.__propertyName__}});return g});this.interceptFunction("splice",
function(b,g){var i,j=this.__observable__.shouldNotifyParent();if(g&&g>0){this.__observable__.notifyChange(tent.changes.EventTypes.REMOVING,{items:this.slice(b,b+g),index:b,propertyName:this.__propertyName__});j&&this.__observable__.notifyParentChanging({type:tent.changes.EventTypes.REMOVING,data:{items:this.slice(b,b+g),index:b,propertyName:this.__propertyName__}})}if(arguments.length>2){i=Array.prototype.slice.call(arguments,2);this.__observable__.notifyChange(tent.changes.EventTypes.ADDING,{items:i,
index:b,propertyName:this.__propertyName__});j&&this.__observable__.notifyParentChanging({type:tent.changes.EventTypes.ADDING,data:{items:i,index:b,propertyName:this.__propertyName__}})}if(i&&i.length>0){var l=i.slice(0);l.unshift(b,g);l=this._splice.apply(this,l)}else l=this._splice(b,g);if(l&&l.length>0){this.__observable__.notifyChange(tent.changes.EventTypes.REMOVED,{items:l,index:b,propertyName:this.__propertyName__});j&&this.__observable__.notifyParentChanged({type:tent.changes.EventTypes.REMOVED,
data:{items:l,index:b,propertyName:this.__propertyName__}})}if(arguments.length>2){this.__observable__.notifyChange(tent.changes.EventTypes.ADDED,{items:i,index:b,propertyName:this.__propertyName__});j&&this.__observable__.notifyParentChanged({type:tent.changes.EventTypes.ADDED,data:{items:i,index:b,propertyName:this.__propertyName__}})}return l});a.remove=tent.arrays.functions.remove;a.set=tent.arrays.functions.set;if(!a.indexOf)a.indexOf=tent.arrays.functions.indexOf;if(!a.lastIndexOf)a.lastIndexOf=
tent.arrays.functions.lastIndexOf;return this};tent.changes.Observable.prototype.removeInterceptor=function(a){var b=this.interceptors[a];if(b._name){if(b.type!=tent.changes.InterceptorTypes.FUNCTION){try{delete this.subject[b.name]}catch(g){tent.log.warn("Error deleting property interceptor '"+b.name+"': "+g)}var i=tent.changes.getPropertyInterceptMode();if(i==tent.changes.PropertyInterceptModes.DEFINEPROPERTY||i==tent.changes.PropertyInterceptModes.DEFINEPROPERTYONLYDOM&&tent.isDOMObject(this.subject))b.descriptor&&
b.descriptor.name&&Object.defineProperty(this.subject,a,b.descriptor);else if(i==tent.changes.PropertyInterceptModes.DEFINESETTER){b.getter&&this.subject.__defineGetter__(a,b.getter);b.setter&&this.subject.__defineSetter__(a,b.setter)}}try{this.subject[b.name]=this.subject[b._name]}catch(j){(i=tent.isDOMObject(this.subject))||tent.log.warn("Error restoring property '"+b.name+"' value: "+j)}try{delete this.subject[b._name]}catch(l){tent.log.warn("Error deleting back storage property '"+b._name+"': "+
l)}}else if(b.type!=tent.changes.InterceptorTypes.FUNCTION){i=this.subject[b.name];delete this.subject[b.name];this.subject[b.name]=i}delete b[a]};tent.changes.Observable.prototype.removeInterceptors=function(){for(var a in this.interceptors)try{this.removeInterceptor(a)}catch(b){tent.log.warn("Error removing interceptor from property '"+a+"': "+b)}this.interceptors={}};tent.changes.Observable.prototype.suspend=function(){this.suspended=true};tent.changes.Observable.prototype.resume=function(){this.suspended=
false;if(this.changesWhileSuspended){if(this.changesWhileSuspended.length<5)for(var a=0,b=this.changesWhileSuspended.length;a<b;a++)this.notifyChange(this.changesWhileSuspended[a]);else this.changesWhileSuspended.length>1&&this.notifyChange(tent.changes.EventTypes.MANYCHANGES,this.changesWhileSuspended);delete this.changesWhileSuspended}};tent.changes.Observable.prototype.isValidHandler=function(a){if(!a)return false;if(typeof a=="function"||typeof a=="object"&&typeof a.handle=="function")return true;
return false};tent.changes.Observable.prototype.bind=function(a,b){if(!b)if(this.isValidHandler(a)){b=a;a=tent.changes.EventTypes.ANY}else throw"must specify a handler: function (Change) or and object with a handle(Change) function";if(!this.isValidHandler(b))throw"must specify a handler: function (Change) or and object with a handle(Change) function";if(!a)a=tent.changes.EventTypes.ANY;var g=this.handlers[a];g||(g=this.handlers[a]=[]);for(var i=0;i<g.length;i++)if(g[i]==b)return false;this.handlers[a].push(b);
return true};tent.changes.Observable.prototype.unbind=function(a,b){if(!b)if(this.isValidHandler(a)){b=a;a=tent.changes.EventTypes.ANY}else throw"must specify a handler to remove";if(!this.isValidHandler(b))throw"must specify a handler to remove";if(!a)a=tent.changes.EventTypes.ANY;var g=this.handlers[a],i=false;if(g)for(var j=0,l=g.length;j<l;j++)if(g[j]==b){g.splice(j,1);j--;l--;i=true}return i};tent.changes.Observable.prototype.unbindWhere=function(a){var b=false,g;for(g in this.handlers)for(var i=
this.handlers[g],j=0,l=i.length;j<l;j++)if(a(i[j])){i.splice(j,1);j--;l--;b=true}return b};tent.changes.Observable.prototype.notifyHandler=function(a,b){try{return typeof b=="function"?b.call(this.subject,a):b.handle(a)}catch(g){var i="";if(g.stack)i+=g.stack;else if(g.message)i+=g.message;tent.log.error("Change Handler Error: "+g+(i?"\n"+i:""));return g}};tent.changes.Observable.prototype.notifyChange=function(a,b){if(this.suspended){if(!this.changesWhileSuspended){this.changesWhileSuspended=[];
if(!this.changesWhileSuspended.filter)this.changesWhileSuspended.filter=tent.arrays.functions.filter;this.changesWhileSuspended.findByEventType=function(){for(var m=0,p=this.length;m<p;m++)for(var n=0,q=arguments.length;n<q;n++)if(this[m].eventType==arguments[n])return this[m]};this.changesWhileSuspended.findPropertyChanged=function(m,p){for(var n=0,q=this.length;n<q;n++)if(this[n].subject==m&&this[n].eventType==tent.changes.EventTypes.CHANGED&&this[n].data.propertyName==p)return this[n]};this.changesWhileSuspended.findArrayChanged=
function(){for(var m=0,p=this.length;m<p;m++)if(this[m].subject==subject&&(this[m].eventType==tent.changes.EventTypes.ADDED||this[m].eventType==tent.changes.EventTypes.REMOVED))return this[m]}}this.changesWhileSuspended.push(new tent.changes.Change(this.subject,a,b))}else{var g;g=a instanceof tent.changes.Change?a:new tent.changes.Change(this.subject,a,b);var i=this.handlers[a];if(i)for(var j=0,l=i.length;j<l;j++)this.notifyHandler(g,i[j]);if(i=this.handlers[tent.changes.EventTypes.ANY]){j=0;for(l=
i.length;j<l;j++)this.notifyHandler(g,i[j])}}};var h;tent.changes.Observable.prototype.log=function(a){if(typeof a=="undefined")a=true;if(a){h||(h=new tent.changes.LogHandler);return this.bind(h)}else if(h)return this.unbind(h);return false};tent.changes.LogHandler=function(a){if(typeof a=="undefined")a="";else if(a&&a[a.length-1]!=" ")a+=" ";this.prefix=a};tent.changes.LogHandler.prototype.handle=function(a){tent.log.info(this.prefix+a.toString())};var k=function(a){var b={};for(opName in a)if(opName!=
"deepStack"&&opName!="liveHandler")b[opName]=a[opName];a=function(g){if(g.eventType==tent.changes.EventTypes.CHANGED){if(typeof g.data.current=="object")if(b.deepOverDOM||!tent.isDOMObject(g.data.current)){b.deepStack=[g.data.subject];tent.changes.track(g.data.current,b);delete b.deepStack}}else if(g.eventType==tent.changes.EventTypes.ADDED)for(var i=0,j=g.data.items.length;i<j;i++)if(typeof g.data.items[i]=="object")if(b.deepOverDOM||!tent.isDOMObject(g.data.current)){b.deepStack=[g.data.subject];
tent.changes.track(g.data.items[i],b);delete b.deepStack}};a.isLivePropagator=true;return a};tent.changes.track=function(a,b){b||(b={});if(typeof a!="object"){if(!b.deepStack)throw"Cannot track changes of "+typeof a;return false}else if(a==null){if(!b.deepStack)throw"Cannot track changes of null";return false}if(b.attachedObjects===false&&a.__collection__)return false;var g=a instanceof Array,i=false;if(!b.remove&&!b.removeAll&&!a.__observable__){if(b.observable&&(!b.observable.subject||b.observable.subject==
a)){a.__observable__=b.observable;a.__observable__.subject=a}else a.__observable__=new tent.changes.Observable(a);i=true;if(!b.interceptOptions)b.interceptOptions={};g?a.__observable__.interceptArrayModifiers(b.interceptOptions):a.__observable__.interceptProperties(b.interceptOptions)}if(b.parentObject&&typeof b.parentObjectPropertyName){if(a.__observable__.parentObject!==b.parentObject){a.__observable__.parentObject=b.parentObject;i=true}if(a.__observable__.parentObjectPropertyName!==b.parentObjectPropertyName){a.__observable__.parentObjectPropertyName=
b.parentObjectPropertyName;i=true}}else if(b.parentObject===false){if(typeof a.__observable__.parentObject!="undefined"){delete a.__observable__.parentObject;i=true}if(a.__observable__.parentObjectPropertyName!="undefined"){delete a.__observable__.parentObjectPropertyName;i=true}}if(b.bindings)for(var j=0,l=b.bindings.length;j<l;j++){var m=b.bindings[j];if(g&&m.bindArrays!=false||!g&&m.bindObjects!=false)if(b.remove){if(a.__observable__&&a.__observable__.unbind(m.eventType,m.handler))i=true}else if(a.__observable__.bind(m.eventType,
m.handler))i=true}if(b.log)if(a.__observable__&&a.__observable__.log(!b.remove))i=true;if(b.reverseProperties)if(b.remove){if(a.__observable__&&a.__observable__.unbind(tent.changes.reverseProperties.getHandler()))i=true}else if(a.__observable__.bind(tent.changes.reverseProperties.getHandler()))i=true;if(b.removeAll&&a.__observable__){a.__observable__.removeInterceptors();delete a.__observable__.subject;delete a.__observable__;i=true}if(b.deep&&b.live&&!b.remove)if(b.remove){if(a.__observable__.unbindWhere(function(n){return n.isLivePropagator}))i=
true}else{if(!b.liveHandler)b.liveHandler=k(b);if(a.__observable__.bind(b.liveHandler))i=true}if(b.deep){if(b.deepStack)b.deepStack.push(a);else{b.deepStack=[a];if(!b.deepStack.lastIndexOf)b.deepStack.lastIndexOf=tent.arrays.functions.lastIndexOf}if(g){j=0;for(l=a.length;j<l;j++)if((g=a[j])&&typeof g=="object"&&b.deepStack.lastIndexOf(g)<0)if(tent.changes.track(g,b))i=true}else{j=b.propertyFilter||f;for(var p in a)if(typeof a[p]!="function"&&j(a,p)){g=a[p];if(b.deepOverDOM||!tent.isDOMObject(g))if(typeof g==
"object"&&b.deepStack.lastIndexOf(g)<0)if(tent.changes.track(g,b))i=true}}b.deepStack.pop()}return i};tent.changes.untrack=function(a,b){if(b){if(!b.removeAll)b.removeAll=true}else b={removeAll:true};return tent.changes.track(a,b)};tent.changes.isTracked=function(a){return a.__observable__&&a.__observable__ instanceof tent.changes.Observable};tent.changes.bind=function(a,b){var g;if(typeof b=="string"){g=b;b={bindings:[]}}else if(typeof b=="function")b={bindings:[{handler:b}]};else if(typeof b=="object"&&
typeof b.handle=="function")b={bindings:[{handler:b}]};if(arguments.length>2){if(b){if(!b.bindings)b.bindings=[]}else b={bindings:[]};for(var i=2;i<arguments.length;i++)b.bindings.push({eventType:g,handler:arguments[i]})}return tent.changes.track(a,b)};tent.changes.unbind=function(a,b){var g;if(typeof b=="string"){g=b;b={bindings:[]}}else if(typeof b=="function")b={bindings:[{handler:b}]};else if(typeof b=="object"&&typeof b.handle=="function")b={bindings:[{handler:b}]};if(arguments.length>2){if(b){if(!b.bindings)b.bindings=
[]}else b={bindings:[]};for(var i=2;i<arguments.length;i++)b.bindings.push({eventType:g,handler:arguments[i]})}if(b){if(!b.remove)b.remove=true}else b={remove:true};return tent.changes.track(a,b)}});tent.declare("tent.changes.reverseProperties",function(){tent.changes.reverseProperties.setReverseProperty=function(c,d,f){f||(f={});f.cardinality=f.cardinality?f.cardinality.toLowerCase():"11";if(!f.reverse)f.reverse=d+"Of";var h={name:f.reverse,cardinality:f.cardinality};if(f.cardinality.substr(0,1)==="n"||f.cardinality.substr(0,1)==="m")h.isArray=true;if(!c.__reverseProperties__)c.__reverseProperties__={};if(f.cardinality.substr(1,1)==="n"||f.cardinality.substr(1,1)==="m"){if(typeof c[d]=="undefined"||
!(c[d]instanceof Array))c[d]=[];c.__reverseProperties__[d]=h;c[d].__parent__=c;c[d].__reverseProperty__=h}else{if(typeof c[d]=="undefined")c[d]=null;c.__reverseProperties__[d]=h}};tent.changes.reverseProperties.setReverseProperties=function(c,d){if(d)for(var f in d)d[f].reverse&&tent.changes.reverseProperties.setReverseProperty(c,f,d[f])};tent.changes.reverseProperties.Set=function(c){this.properties=c};tent.changes.reverseProperties.Set.prototype.create=function(){var c={};this.applyTo(c);return c};
tent.changes.reverseProperties.Set.prototype.applyTo=function(){var c=[];c.bind=function(f){f||(f={});f.reverseProperties=true;for(var h=0;h<this.length;h++){var k=this[h];if(k.__reverseProperties__){tent.changes.bind(k,f);var a=k.__reverseProperties__,b;for(b in a)if(a.hasOwnProperty(b))if(a[b].cardinality&&(a[b].cardinality[1]=="n"||a[b].cardinality[1]=="m")){if(!(k[b]instanceof Array)){k[b]=[];k[b].__parent__=k;k[b].__reverseProperty__=k.__reverseProperties__[b]}tent.changes.bind(k[b],f)}}}};if(this.properties){for(var d=
0;d<arguments.length;d++)tent.changes.reverseProperties.setReverseProperties(arguments[d],this.properties);c.push.apply(c,arguments)}return c};var e;tent.changes.reverseProperties.getHandler=function(){e||(e=function(c){if(c.eventType==tent.changes.EventTypes.ADDED){var d=c.data.items;if(d&&c.subject&&c.subject.__reverseProperty__){var f=c.subject.__reverseProperty__;c=c.subject.__parent__;for(var h=0,k=d.length;h<k;h++){var a=d[h];if(f.isArray){a[f.name]||(a[f.name]=[]);a[f.name].indexOf(c)<0&&a[f.name].push(c)}else if(a[f.name]!=
c){if(typeof a[f.name]!="undefined"&&a[f.name]!=null)throw Error("this."+f.name+" is set. Remove this from its current array before adding it to this array");a[f.name]=c}}}}else if(c.eventType==tent.changes.EventTypes.REMOVED){if((d=c.data.items)&&c.subject&&c.subject.__reverseProperty__){f=c.subject.__reverseProperty__;c=c.subject.__parent__;h=0;for(k=d.length;h<k;h++){a=d[h];if(f.isArray){if(a=a[f.name])for(var b=0,g=a.length;b<g;b++)if(a[b]===c){a.splice(b,1);b--;g--}}else if(a[f.name]===c)a[f.name]=
null}}}else if(c.eventType==tent.changes.EventTypes.CHANGED)if(c.data.propertyName&&c.subject&&c.subject.__reverseProperties__)if(f=c.subject.__reverseProperties__[c.data.propertyName])if(f.isArray){if(a=c.data.oldValue){a=a[f.name];if(a instanceof Array){h=0;for(k=a.length;h<k;h++)if(a[h]===c.subject){a.splice(h,1);h--;k--}}}if(a=c.data.current){a[f.name]||(a[f.name]=[]);a[f.name]instanceof Array&&a[f.name].indexOf(c.subject)<0&&a[f.name].push(c.subject)}}else{if(a=c.data.oldValue)if(a[f.name]==
c.subject)a[f.name]=null;if(a=c.data.current)if(a[f.name]!=c.subject)a[f.name]=c.subject}});return e}});
